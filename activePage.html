<!DOCTYPE html>
<html>
<head>
    <script src="node_modules/simplewebrtc/latest-v2.js"></script>
    <script src="node_modules/page/page.js"></script>
    <!--<script src="jquery-3.1.1.min.js"></script>-->
</head>
<body>
<video height="300" id="localVideo"></video>
<div id="remotesVideos"></div>
<div id="end-call" onclick="endCall()">End call</div>

<script>
    var webrtc = new SimpleWebRTC({
        // the id/element dom element that will hold "our" video
        localVideoEl: 'localVideo',
        // the id/element dom element that will hold remote videos
        remoteVideosEl: 'remotesVideos',
        // immediately ask for camera access
        autoRequestMedia: true
    });

    webrtc.on('readyToCall', function () {
        // you can name it anything
        var room = location.search.split('?')[1];
        webrtc.joinRoom(room);
    });

    function endCall() {

        webrtc.sendToAll('callEnded', "emded");
        webrtc.disconnect();
        page('/');
    }

    webrtc.connection.on('message', function (data) {
        if (data.type == 'callEnded') {
            webrtc.disconnect();
            page('/');
        }
    })

</script>

</body>
</html>